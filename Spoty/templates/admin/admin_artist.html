<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artist List</title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #121212;
            margin: 0;
            padding: 0;
            color: #ffffff;
        }

        .navbar {
            background-color: #1db954;
            overflow: hidden;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
        }

        .navbar a {
            color: white;
            text-align: center;
            padding: 14px 20px;
            text-decoration: none;
            transition: background-color 0.3s, transform 0.2s;
        }

        .navbar a:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .navbar a.active {
            background-color: #1aa34a;
        }

        .logout-btn {
            background-color: #dc3545;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s, transform 0.2s;
        }

        .logout-btn:hover {
            background-color: #c82333;
            transform: scale(1.05);
        }

        .container {
            width: 90%;
            max-width: 1200px; /* Limit the width on larger screens */
            margin: 50px auto;
            background-color: #181818;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }

        h1, h2, h3 {
            text-align: center;
            color: #ffffff;
        }

        .artist-list, .banned-artist-list, .queries-list {
            list-style: none;
            padding: 0;
        }

        .artist-card, .banned-artist-card, .query-card {
            background-color: #282828;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
            transition: background-color 0.3s, transform 0.2s;
        }

        .artist-card:hover, .banned-artist-card:hover, .query-card:hover {
            background-color: #333333;
            transform: translateY(-2px);
        }

        .artist-info, .banned-artist-info, .query-info {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .artist-info p, .banned-artist-info p, .query-info p {
            margin: 5px 0;
            color: #b3b3b3;
        }

        .artist-actions, .banned-artist-actions {
            display: flex;
            gap: 10px;
        }

        .artist-actions button, .banned-artist-actions button {
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            transition: background-color 0.3s, transform 0.2s;
        }

        .ban-btn {
            background-color: #dc3545;
        }

        .ban-btn:hover {
            background-color: #c82333;
            transform: scale(1.05);
        }

        .songs-btn {
            background-color: #35a2dc;
        }

        .songs-btn:hover {
            background-color: #2a8cba;
            transform: scale(1.05);
        }

        /* Queries Section */
        .query-btn {
            background-color: #1db954;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s, transform 0.2s;
        }

        .query-btn:hover {
            background-color: #1aa34a;
            transform: scale(1.05);
        }

        /* Responsive Design */
        @media (max-width: 600px) {
            .container {
                width: 95%;
                padding: 15px;
            }

            .artist-card, .banned-artist-card, .query-card {
                flex-direction: column; /* Stack elements vertically on smaller screens */
                align-items: flex-start; /* Align items to the start */
            }

            .artist-actions {
                justify-content: center; /* Center buttons on small screens */
                margin-top: 10px; /* Add space between info and actions */
            }
        }
    </style>
</head>
<body>

    <!-- Navbar -->
    <div class="navbar">
        <div>
            <a href="{{url_for('admin_users')}}">User</a>
            <a href="#" class="active">Artist</a>
        </div>
        <!-- Logout Button -->
        <button class="logout-btn" onclick="logout()">Logout</button>
    </div>

    <!-- Main Content -->
    <div class="container">
        <h1>Artist List</h1>

        <!-- Active Artists Section -->
        <h2>Active Artists</h2>
        <ul id="artist-list" class="artist-list">
            {% for artist in artists %}
            <li class="artist-card">
                <div class="artist-info">
                    <p>Name: {{artist.name}}</p>
                    <p>Email: {{artist.email}}</p>
                    <p>Phone: {{artist.phone}}</p>
                </div>
                <div class="artist-actions">
                    <form action="{{url_for('admin_artist_songs', artist_id=artist._id)}}" method="post">
                        <button type="submit" class="songs-btn">Songs</button>
                    </form>
                    <button class="ban-btn" data-artist-email="{{artist.email}}"
                        onclick="banArtist('{{artist.email}}')">Ban User</button>
                </div>
            </li>
            {% endfor %}
        </ul>

        <!-- Banned Artists Section -->
        <h2>Banned Artists</h2>
        <ul id="banned-artist-list" class="banned-artist-list">
            {% for banned_artist in banned_artists %}
            <li class="banned-artist-card">
                <div class="banned-artist-info">
                    <p>Name: {{banned_artist.name}}</p>
                    <p>Email: {{banned_artist.email}}</p>
                    <p>Phone: {{banned_artist.phone}}</p>
                </div>
                <div class="banned-artist-actions">
                    <button class="unban-btn" 
                            data-artist-email="{{banned_artist.email}}"
                            onclick="unbanArtist('{{banned_artist.email}}')">Unban User</button>
                </div>
            </li>
            {% endfor %}
        </ul>

        <!-- Artist Queries Section -->
        <h3>Artist Queries</h3>
        <p>
            <a href="{{ url_for('admin_queries') }}">View All Artist Queries</a>
        </p>
    </div>

    <script>
        async function logout() {
            try {
                const response = await fetch('/logout', {
                    method: 'GET',
                });
                if (response.ok) {
                    window.location.href = '/admin-login';
                } else {
                    console.error('Failed to logout');
                }
            } catch (error) {
                console.error('Error during logout:', error);
            }
        }

        async function banArtist(artistEmail) {
            // Show a confirmation dialog
            const confirmed = confirm("Are you sure you want to ban this artist?");
            if (!confirmed) {
                return; // Exit the function if not confirmed
            }

            try {
                const response = await fetch('/banArtist', {
                    method: 'POST',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ "artistEmail": artistEmail }),
                });

                if (response.ok) {
                    // Remove the artist from the list after successful ban
                    const artistCard = document.querySelector(`button[data-artist-email='${artistEmail}']`).closest('.artist-card');
                    artistCard.remove();
                } else {
                    console.error('Failed to ban artist');
                }
            } catch (error) {
                console.error('Error during banning artist:', error);
            }
        }

        async function unbanArtist(artistEmail) {
            // Show a confirmation dialog
            const confirmed = confirm("Are you sure you want to unban this artist?");
            if (!confirmed) {
                return; // Exit the function if not confirmed
            }

            try {
                const response = await fetch('/unbanArtist', {
                    method: 'POST',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ "artistEmail": artistEmail }),
                });

                if (response.ok) {
                    // Remove the artist from the banned list after successful unban
                    const bannedArtistCard = document.querySelector(`button[data-artist-email='${artistEmail}']`).closest('.banned-artist-card');
                    bannedArtistCard.remove();
                } else {
                    console.error('Failed to unban artist');
                }
            } catch (error) {
                console.error('Error during unbanning artist:', error);
            }
        }

        function viewQueryDetails(queryId) {
            // Logic to view query details
            alert(`Viewing details for query ID: ${queryId}`);
        }
    </script>
</body>
</html>
